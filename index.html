---
layout: home
---
<html>

<head>
    <link rel="stylesheet" href="styles.css">
</head>

<h2>Abstract</h2>

<p>In this paper, we propose a novel method to generate polyphonic music scores with a diffusion model by regarding
    music
    as image-like piano roll representations. We distinguish between two paradigms of <i>controllable</i> music
    generation
    under a diffusion framework: internal control and external control. Internal control refers to the process that
    users
    first pre-define a part of the music and let the model infill the rest, which is similar to the task of masked music
    generation (or music inpainting). External control means to condition the model with external yet related
    information,
    such as chord, texture, or other statistics of music, via the cross-attention mechanism. We show that by using
    internal
    and external controls, our model unifies a wide range of music creation tasks, including melody generation given
    accompaniment, accompaniment generation given melody, arbitrary music segment inpainting, and general music
    arrangement
    given chords or textures. Experimental results show that our model achieves better generative quality compared to
    existing autoregressive and sampling-based baselines, and using pre-trained disentangled representations as external
    conditions yields more effective controls.
</p>

<hr color="#E8E8E8">
<br>


<p>
    In each MIDI visualization block, <font color="#2B7ADB">blue</font> notes denote the generated results. Except for
    the iterative inpainting demo,
    all the demos are 8-bar long (16s).
</p>


<h2>Generation</h2>

<midi-player src="/media/uncond_pop909wm_1.mid" sound-font visualizer="#Vis_uncond"> </midi-player>
<midi-player src="/media/uncond_pop909_1.mid" sound-font visualizer="#Vis_uncond"> </midi-player>
<midi-player src="/media/uncond_pop909wm_0.mid" sound-font visualizer="#Vis_uncond"> </midi-player>
<midi-player src="/media/uncond_pop909_3.mid" sound-font visualizer="#Vis_uncond"> </midi-player>

<midi-visualizer type="piano-roll" id="Vis_uncond"> </midi-visualizer>
<br>

<h2>Melody generation given accompaniment</h2>

<section id="inp">
    Accompaniment:
    <midi-player src="/media/uncond_inp_above_acc.mid" sound-font visualizer="#Vis_inp_above_acc"> </midi-player>
    <midi-visualizer src="/media/uncond_inp_above_acc.mid" type="piano-roll" id="Vis_inp_above_acc"> </midi-visualizer>

    Inpainted results:
    <midi-player src="/media/uncond_inp_above_0_split.mid" sound-font visualizer="#Vis_inp_above"> </midi-player>
    <midi-player src="/media/uncond_inp_above_1_split.mid" sound-font visualizer="#Vis_inp_above"> </midi-player>
    <midi-visualizer type="piano-roll" id="Vis_inp_above"> </midi-visualizer>
</section>
<br>


<h2>Accompaniment generation given melody</h2>

<section id="inp">
    Melody:
    <midi-player src="/media/uncond_inp_below_ode_mld.mid" sound-font visualizer="#Vis_inp_below_mld_1"> </midi-player>
    <midi-visualizer src="/media/uncond_inp_below_ode_mld.mid" type="piano-roll" id="Vis_inp_below_mld_1">
    </midi-visualizer>

    Inpainted results:
    <midi-player src="/media/uncond_inp_below_ode_0_split.mid" sound-font visualizer="#Vis_inp_below_1"> </midi-player>
    <midi-player src="/media/uncond_inp_below_ode_1_split.mid" sound-font visualizer="#Vis_inp_below_1"> </midi-player>
    <midi-visualizer type="piano-roll" id="Vis_inp_below_1"> </midi-visualizer>
</section>
<br>
<section id="inp">
    Melody:
    <midi-player src="/media/uncond_inp_below_canon_mld.mid" sound-font visualizer="#Vis_inp_below_mld"> </midi-player>
    <midi-visualizer src="/media/uncond_inp_below_canon_mld.mid" type="piano-roll" id="Vis_inp_below_mld">
    </midi-visualizer>

    Inpainted results:
    <midi-player src="/media/uncond_inp_below_canon_0_split.mid" sound-font visualizer="#Vis_inp_below"> </midi-player>
    <midi-player src="/media/uncond_inp_below_canon_1_split.mid" sound-font visualizer="#Vis_inp_below"> </midi-player>
    <midi-visualizer type="piano-roll" id="Vis_inp_below"> </midi-visualizer>
</section>
<br>

<h2>Arbitrary segment inpainting</h2>

<section id="inp">
    Original segment:
    <midi-player src="/media/uncond_inp_bars_orig.mid" sound-font visualizer="#Vis_inp_bars_orig"> </midi-player>
    <midi-visualizer src="/media/uncond_inp_bars_orig.mid" type="piano-roll" id="Vis_inp_bars_orig"> </midi-visualizer>

    Inpainted results:
    <midi-player src="/media/uncond_inp_bars_0.mid" sound-font visualizer="#Vis_inp_bars"> </midi-player>
    <midi-player src="/media/uncond_inp_bars_1.mid" sound-font visualizer="#Vis_inp_bars"> </midi-player>
    <midi-visualizer type="piano-roll" id="Vis_inp_bars"> </midi-visualizer>
</section>
<br>

<h2>Iterative inpainting for long-term generation</h2>

<midi-player src="/media/uncond_autoreg_0.mid" sound-font visualizer="#Vis_inp_autoreg"> </midi-player>
<midi-visualizer src="/media/uncond_autoreg_0.mid" type="piano-roll" id="Vis_inp_autoreg"> </midi-visualizer>
<br>

<h2>Generation with chord conditioning</h2>

<section id="inp">
    Chord progression (condition):
    <midi-player src="/media/chd_v_chd.mid" sound-font visualizer="#Vis_chd_v_chd"> </midi-player>
    <midi-visualizer src="/media/chd_v_chd.mid" type="piano-roll" id="Vis_chd_v_chd"> </midi-visualizer>
</section>

Generation (no guidance):
<midi-player src="/media/chd_v_0.mid" sound-font visualizer="#Vis_chd_v"> </midi-player>
<!-- <midi-player src="/media/chd_v_1.mid" sound-font visualizer="#Vis_chd_v"> </midi-player> -->
<midi-player src="/media/chd_v_2.mid" sound-font visualizer="#Vis_chd_v"> </midi-player>

Generation (guidance scale = 5)
<midi-player src="/media/chd_gs_5.mid" sound-font visualizer="#Vis_chd_v"> </midi-player>
<midi-visualizer type="piano-roll" id="Vis_chd_v"> </midi-visualizer>

<!-- <section id="inp"> -->
<!--     Chord progression (condition): -->
<!--     <midi-player src="/media/chd_gs_chd.mid" sound-font visualizer="#Vis_chd_gs_chd"> </midi-player> -->
<!--     <midi-visualizer src="/media/chd_gs_chd.mid" type="piano-roll" id="Vis_chd_gs_chd"> </midi-visualizer> -->
<!-- </section> -->

<!-- Generation (same seed with different guidance scales): -->
<!-- <br> -->
<!-- guidance scale = 1 -->
<!-- <midi-player src="/media/chd_gs_1.mid" sound-font visualizer="#Vis_chd_gs"> </midi-player> -->
<!-- guidance scale = 3 -->
<!-- <midi-player src="/media/chd_gs_3.mid" sound-font visualizer="#Vis_chd_gs"> </midi-player> -->
<!-- guidance scale = 5 -->
<!-- <midi-player src="/media/chd_gs_5.mid" sound-font visualizer="#Vis_chd_gs"> </midi-player> -->
<!-- guidance scale = 10 -->
<!-- <midi-player src="/media/chd_gs_10.mid" sound-font visualizer="#Vis_chd_gs"> </midi-player> -->
<!-- <midi-visualizer type="piano-roll" id="Vis_chd_gs"> </midi-visualizer> -->
<br>

<h2>Generation with texture conditioning</h2>

<section id="inp">
    Texture MIDI (condition):
    <midi-player src="/media/txt_v_txt.mid" sound-font visualizer="#Vis_txt_v_txt"> </midi-player>
    <midi-visualizer src="/media/txt_v_txt.mid" type="piano-roll" id="Vis_txt_v_txt"> </midi-visualizer>
</section>

Generation (no guidance):
<midi-player src="/media/txt_v_0.mid" sound-font visualizer="#Vis_txt_v"> </midi-player>
<midi-player src="/media/txt_v_1.mid" sound-font visualizer="#Vis_txt_v"> </midi-player>
<!-- <midi-player src="/media/txt_v_2.mid" sound-font visualizer="#Vis_txt_v"> </midi-player> -->
Generation (guidance scale = 5)
<midi-player src="/media/txt_gs_5.mid" sound-font visualizer="#Vis_txt_v"> </midi-player>
<midi-visualizer type="piano-roll" id="Vis_txt_v"> </midi-visualizer>

<!-- <section id="inp"> -->
<!--     Texture MIDI (condition): -->
<!--     <midi-player src="/media/txt_gs_txt.mid" sound-font visualizer="#Vis_txt_gs_txt"> </midi-player> -->
<!--     <midi-visualizer src="/media/txt_gs_txt.mid" type="piano-roll" id="Vis_txt_gs_txt"> </midi-visualizer> -->
<!-- </section> -->

<!-- Generation (same seed with different guidance scales): -->
<!-- <br> -->
<!-- guidance scale = 1 -->
<!-- <midi-player src="/media/txt_gs_1.mid" sound-font visualizer="#Vis_txt_gs"> </midi-player> -->
<!-- guidance scale = 3 -->
<!-- <midi-player src="/media/txt_gs_3.mid" sound-font visualizer="#Vis_txt_gs"> </midi-player> -->
<!-- guidance scale = 5 -->
<!-- <midi-player src="/media/txt_gs_5.mid" sound-font visualizer="#Vis_txt_gs"> </midi-player> -->
<!-- guidance scale = 10 -->
<!-- <midi-player src="/media/txt_gs_10.mid" sound-font visualizer="#Vis_txt_gs"> </midi-player> -->
<!-- <midi-visualizer type="piano-roll" id="Vis_txt_gs"> </midi-visualizer> -->
<br>

<h2>Chord-specified accompaniment generation given melody</h2>

<section id="inp">
    Melody:
    <midi-player src="/media/uncond_inp_below_canon_mld.mid" sound-font visualizer="#Vis_chd_inp_below_mld">
    </midi-player>
    <midi-visualizer src="/media/uncond_inp_below_canon_mld.mid" type="piano-roll" id="Vis_chd_inp_below_mld">
    </midi-visualizer>

    Chord progression (condition):
    <midi-player src="/media/chd_v_chd.mid" sound-font visualizer="#Vis_chd_inp_below_chd"> </midi-player>
    <midi-visualizer src="/media/chd_v_chd.mid" type="piano-roll" id="Vis_chd_inp_below_chd"> </midi-visualizer>

    Inpainted results:

    <midi-player src="/media/chd_inp_below_canon_0_split.mid" sound-font visualizer="#Vis_chd_inp_below"> </midi-player>
    <midi-player src="/media/chd_inp_below_canon_1_split.mid" sound-font visualizer="#Vis_chd_inp_below"> </midi-player>
    <midi-visualizer type="piano-roll" id="Vis_chd_inp_below"> </midi-visualizer>
</section>
<br>

<h2>Texture-specified melody generation given accompaniment</h2>

<section id="inp">
    Accompaniment:
    <midi-player src="/media/txt_inp_above_acc.mid" sound-font visualizer="#Vis_txt_inp_above_acc"> </midi-player>
    <midi-visualizer src="/media/txt_inp_above_acc.mid" type="piano-roll" id="Vis_txt_inp_above_acc">
    </midi-visualizer>

    Texture MIDI (condition):
    <midi-player src="/media/txt_inp_above_txt.mid" sound-font visualizer="#Vis_txt_inp_above_txt"> </midi-player>
    <midi-visualizer src="/media/txt_inp_above_txt.mid" type="piano-roll" id="Vis_txt_inp_above_txt"> </midi-visualizer>

    Inpainted results:

    <midi-player src="/media/txt_inp_above_0.mid" sound-font visualizer="#Vis_txt_inp_above"> </midi-player>
    <midi-player src="/media/txt_inp_above_1.mid" sound-font visualizer="#Vis_txt_inp_above"> </midi-player>
    <midi-visualizer type="piano-roll" id="Vis_txt_inp_above"> </midi-visualizer>
</section>
<br>


<script
    src="https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.5.0"></script>

Thanks <a href="https://cifkao.github.io/html-midi-player/">html-midi-player</a> for the excellent MIDI visualization.

</html>
